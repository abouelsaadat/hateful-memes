optimizer = torch.optim.AdamW([
    {"params": model.visualbert.parameters(), "lr": 2e-5, "weight_decay": 0},
    {"params": model.classifier.parameters(),  "lr": 2e-3, "weight_decay": 1e-5},
])

Epoch 0
Val Loss: 2.0465 | ACC: 0.6141 | F1: 0.0000 | AUC: 0.5029
Epoch 1
Train Loss: 175.0277 | ACC: 0.6191 | F1: 0.5173 | AUC: 0.6557
Val Loss: 2.0568 | ACC: 0.6000 | F1: 0.3568 | AUC: 0.6056
Epoch 2
Train Loss: 158.7519 | ACC: 0.6892 | F1: 0.5998 | AUC: 0.7436
Val Loss: 2.1300 | ACC: 0.6125 | F1: 0.4609 | AUC: 0.6233
Epoch 3
Train Loss: 147.5075 | ACC: 0.7301 | F1: 0.6441 | AUC: 0.7895
Val Loss: 2.0488 | ACC: 0.6234 | F1: 0.4408 | AUC: 0.6316
Epoch 4
Train Loss: 137.1671 | ACC: 0.7571 | F1: 0.6727 | AUC: 0.8237
Val Loss: 2.1502 | ACC: 0.6141 | F1: 0.5166 | AUC: 0.6408
Epoch 5
Train Loss: 124.0938 | ACC: 0.7811 | F1: 0.7114 | AUC: 0.8592
Val Loss: 2.1551 | ACC: 0.6641 | F1: 0.4988 | AUC: 0.6653
Epoch 6
Train Loss: 109.8070 | ACC: 0.8104 | F1: 0.7493 | AUC: 0.8916
Val Loss: 2.1220 | ACC: 0.6484 | F1: 0.5322 | AUC: 0.6693
Epoch 7
Train Loss: 100.4526 | ACC: 0.8328 | F1: 0.7781 | AUC: 0.9114
Val Loss: 2.3118 | ACC: 0.6516 | F1: 0.5011 | AUC: 0.6695
Epoch 8
Train Loss: 87.6121 | ACC: 0.8547 | F1: 0.8084 | AUC: 0.9331
Val Loss: 2.3452 | ACC: 0.6469 | F1: 0.4910 | AUC: 0.6833
Epoch 9
Train Loss: 75.6807 | ACC: 0.8726 | F1: 0.8319 | AUC: 0.9501
Val Loss: 2.6005 | ACC: 0.6484 | F1: 0.4656 | AUC: 0.6707
Epoch 10
Train Loss: 66.7444 | ACC: 0.8916 | F1: 0.8559 | AUC: 0.9614
Val Loss: 2.6195 | ACC: 0.6562 | F1: 0.5279 | AUC: 0.6709
Epoch 11
Train Loss: 60.5467 | ACC: 0.9014 | F1: 0.8685 | AUC: 0.9680
Val Loss: 3.3761 | ACC: 0.6469 | F1: 0.4115 | AUC: 0.6568
Epoch 12
Train Loss: 52.4612 | ACC: 0.9193 | F1: 0.8909 | AUC: 0.9759
Val Loss: 3.5915 | ACC: 0.6453 | F1: 0.4423 | AUC: 0.6526
Epoch 13
Train Loss: 48.5753 | ACC: 0.9233 | F1: 0.8971 | AUC: 0.9796
Val Loss: 3.5740 | ACC: 0.6562 | F1: 0.4811 | AUC: 0.6771
Epoch 14
Train Loss: 41.8472 | ACC: 0.9348 | F1: 0.9118 | AUC: 0.9846
Val Loss: 4.0744 | ACC: 0.6672 | F1: 0.4843 | AUC: 0.6681
Epoch 15
Train Loss: 38.6585 | ACC: 0.9422 | F1: 0.9212 | AUC: 0.9867
Val Loss: 3.8623 | ACC: 0.6766 | F1: 0.4509 | AUC: 0.6790
Epoch 16
Train Loss: 34.0248 | ACC: 0.9505 | F1: 0.9321 | AUC: 0.9895
Val Loss: 4.6685 | ACC: 0.6656 | F1: 0.4247 | AUC: 0.6796
Epoch 17
Train Loss: 35.5297 | ACC: 0.9472 | F1: 0.9279 | AUC: 0.9889
Val Loss: 4.0842 | ACC: 0.6562 | F1: 0.5067 | AUC: 0.6828
Epoch 18
Train Loss: 28.1498 | ACC: 0.9586 | F1: 0.9430 | AUC: 0.9928
Val Loss: 5.4375 | ACC: 0.6547 | F1: 0.4623 | AUC: 0.6624
Epoch 19
Train Loss: 27.4205 | ACC: 0.9605 | F1: 0.9454 | AUC: 0.9934
Val Loss: 4.6420 | ACC: 0.6641 | F1: 0.4077 | AUC: 0.6784
Epoch 20
Train Loss: 24.6235 | ACC: 0.9652 | F1: 0.9520 | AUC: 0.9942
Val Loss: 4.7382 | ACC: 0.6687 | F1: 0.4976 | AUC: 0.6858
--> Saved best model (AUC=0.6858)

Test Loss: 21.945636957883835
Test Acc: 0.6673333333333333
Test F1: 0.5126953125
Test AUC: 0.6925648368768329


optimizer = torch.optim.AdamW([
    {"params": model.visualbert.parameters(), "lr": 2e-4, "weight_decay": 0},
    {"params": model.classifier.parameters(),  "lr": 2e-3, "weight_decay": 1e-5},
])
Epoch 0
Val Loss: 2.0465 | ACC: 0.6141 | F1: 0.0000 | AUC: 0.5029
Epoch 1
Train Loss: 178.8336 | ACC: 0.5893 | F1: 0.4829 | AUC: 0.6225
Val Loss: 1.9746 | ACC: 0.6078 | F1: 0.2229 | AUC: 0.6150
Epoch 2
Train Loss: 154.5271 | ACC: 0.7088 | F1: 0.6208 | AUC: 0.7655
Val Loss: 2.0667 | ACC: 0.6141 | F1: 0.4865 | AUC: 0.6384
Epoch 3
Train Loss: 141.3516 | ACC: 0.7438 | F1: 0.6653 | AUC: 0.8110
Val Loss: 2.0727 | ACC: 0.6266 | F1: 0.4128 | AUC: 0.6540
Epoch 4
Train Loss: 129.1225 | ACC: 0.7718 | F1: 0.7037 | AUC: 0.8479
Val Loss: 2.1290 | ACC: 0.6078 | F1: 0.5635 | AUC: 0.6477
Epoch 5
Train Loss: 124.0043 | ACC: 0.7753 | F1: 0.7126 | AUC: 0.8603
Val Loss: 1.9589 | ACC: 0.6547 | F1: 0.4199 | AUC: 0.6620
Epoch 6
Train Loss: 110.0356 | ACC: 0.8073 | F1: 0.7503 | AUC: 0.8920
Val Loss: 2.3453 | ACC: 0.6344 | F1: 0.3842 | AUC: 0.6460
Epoch 7
Train Loss: 98.7464 | ACC: 0.8332 | F1: 0.7834 | AUC: 0.9143
Val Loss: 2.3861 | ACC: 0.6406 | F1: 0.4676 | AUC: 0.6605
Epoch 8
Train Loss: 89.5023 | ACC: 0.8485 | F1: 0.8038 | AUC: 0.9298
Val Loss: 2.4630 | ACC: 0.6328 | F1: 0.4020 | AUC: 0.6758
Epoch 9
Train Loss: 82.1922 | ACC: 0.8612 | F1: 0.8186 | AUC: 0.9406
Val Loss: 2.8268 | ACC: 0.6219 | F1: 0.4319 | AUC: 0.6531
Epoch 10
Train Loss: 73.8842 | ACC: 0.8789 | F1: 0.8421 | AUC: 0.9519
Val Loss: 2.7487 | ACC: 0.6266 | F1: 0.4770 | AUC: 0.6746
Epoch 11
Train Loss: 66.6636 | ACC: 0.8894 | F1: 0.8547 | AUC: 0.9603
Val Loss: 3.7498 | ACC: 0.6547 | F1: 0.4138 | AUC: 0.6613
Epoch 12
Train Loss: 60.8558 | ACC: 0.8993 | F1: 0.8656 | AUC: 0.9678
Val Loss: 2.3863 | ACC: 0.6453 | F1: 0.3914 | AUC: 0.6596
Epoch 13
Train Loss: 56.4157 | ACC: 0.9060 | F1: 0.8748 | AUC: 0.9722
Val Loss: 3.3601 | ACC: 0.6578 | F1: 0.4033 | AUC: 0.6924
Epoch 14
Train Loss: 54.0031 | ACC: 0.9131 | F1: 0.8841 | AUC: 0.9737
Val Loss: 3.4319 | ACC: 0.6359 | F1: 0.4902 | AUC: 0.6613
Epoch 15
Train Loss: 52.8664 | ACC: 0.9127 | F1: 0.8836 | AUC: 0.9751
Val Loss: 5.0809 | ACC: 0.6594 | F1: 0.4044 | AUC: 0.6606
Epoch 16
Train Loss: 51.8402 | ACC: 0.9200 | F1: 0.8926 | AUC: 0.9761
Val Loss: 5.1316 | ACC: 0.6594 | F1: 0.4202 | AUC: 0.6810
Epoch 17
Train Loss: 45.3907 | ACC: 0.9318 | F1: 0.9076 | AUC: 0.9816
Val Loss: 3.7063 | ACC: 0.6328 | F1: 0.4418 | AUC: 0.6577
Epoch 18
Train Loss: 40.1872 | ACC: 0.9361 | F1: 0.9136 | AUC: 0.9853
Val Loss: 4.1795 | ACC: 0.6687 | F1: 0.4301 | AUC: 0.6767
Epoch 19
Train Loss: 37.1453 | ACC: 0.9432 | F1: 0.9226 | AUC: 0.9873
Val Loss: 4.8060 | ACC: 0.6609 | F1: 0.4022 | AUC: 0.6864
Epoch 20
Train Loss: 37.7992 | ACC: 0.9468 | F1: 0.9274 | AUC: 0.9871
Val Loss: 3.5889 | ACC: 0.6672 | F1: 0.4767 | AUC: 0.6887
--> Saved best model (AUC=0.6924)

Test Loss: 13.650564268231392
Test Acc: 0.6593333333333333
Test F1: 0.4785714285714286
Test AUC: 0.7138072763929619
